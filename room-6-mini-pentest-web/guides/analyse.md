# Guide d'Analyse

## Objectif

L'analyse est la troisième étape d'un audit de sécurité. Son objectif est de tester chaque fonctionnalité pour identifier des vulnérabilités en utilisant les connaissances acquises dans les rooms précédentes.

## Pourquoi l'analyse est importante

L'analyse permet de :
- Identifier les vulnérabilités réelles dans l'application
- Comprendre comment exploiter ces vulnérabilités
- Évaluer l'impact de chaque vulnérabilité
- Prioriser les corrections

Sans une analyse méthodique, vous pourriez passer à côté de vulnérabilités critiques.

## Méthodologie

### Étape 1 : Tester les injections SQL

**Définition**

Les injections SQL permettent d'exécuter du code SQL malveillant dans la base de données. Elles sont souvent présentes dans les formulaires de login, les champs de recherche, et les paramètres URL.

**Comment tester**

1. **Identifier les points d'entrée SQL**
   - Formulaires de login
   - Champs de recherche
   - Paramètres URL qui semblent interroger une base de données

2. **Tester avec des payloads SQL**
   - `' OR '1'='1` : Pour bypasser l'authentification
   - `' UNION SELECT NULL--` : Pour extraire des données
   - `'; DROP TABLE users--` : Pour tester la suppression (attention !)

3. **Observer les réponses**
   - Erreurs SQL révélatrices
   - Comportement inattendu
   - Accès non autorisé

**Exemple de test**

```
Formulaire de login :
Username: admin' OR '1'='1
Password: anything

Si cela fonctionne, il y a une injection SQL.
```

**Ce qu'il faut documenter**

- Le point d'entrée vulnérable
- Le payload utilisé
- Le résultat obtenu
- L'impact potentiel

---

### Étape 2 : Tester le XSS

**Définition**

Le XSS (Cross-Site Scripting) permet d'injecter du code JavaScript malveillant dans une page web. Il existe trois types : réfléchi, stocké, et DOM-based.

**Comment tester**

1. **XSS Réfléchi**
   - Tester les paramètres URL
   - Tester les champs de recherche
   - Payload : `<script>alert('XSS')</script>`

2. **XSS Stocké**
   - Tester les formulaires de commentaires
   - Tester les champs de profil
   - Payload : `<img src=x onerror=alert('XSS')>`

3. **XSS DOM-based**
   - Examiner le code JavaScript côté client
   - Tester les fragments d'URL (#)
   - Payload : `#<img src=x onerror=alert('XSS')>`

**Exemple de test**

```
Champ de recherche :
<script>alert('XSS')</script>

Si une alerte s'affiche, il y a un XSS réfléchi.
```

**Ce qu'il faut documenter**

- Le type de XSS (réfléchi, stocké, DOM-based)
- Le point d'entrée vulnérable
- Le payload utilisé
- Le résultat obtenu
- L'impact potentiel (vol de cookies, redirection, etc.)

---

### Étape 3 : Tester l'authentification

**Définition**

Les problèmes d'authentification incluent le bypass de login, les mots de passe faibles, et les sessions non sécurisées.

**Comment tester**

1. **Bypass de login**
   - Injection SQL dans les champs de login
   - Essayer des comptes par défaut (admin/admin, admin/password)
   - Tester avec des caractères spéciaux

2. **Mots de passe**
   - Vérifier si les mots de passe sont stockés en clair
   - Tester la complexité des mots de passe
   - Tester la réinitialisation de mot de passe

3. **Sessions**
   - Vérifier les cookies de session
   - Tester la fixation de session
   - Tester l'expiration des sessions

**Exemple de test**

```
Tentative de connexion avec :
Username: admin' OR '1'='1'--
Password: (vide ou n'importe quoi)

Si la connexion réussit, il y a un bypass d'authentification.
```

**Ce qu'il faut documenter**

- Le problème d'authentification identifié
- La méthode utilisée pour l'exploiter
- Le résultat obtenu
- L'impact potentiel

---

### Étape 4 : Tester l'autorisation

**Définition**

Les problèmes d'autorisation incluent l'accès non autorisé à des ressources, l'élévation de privilèges, et le contournement des contrôles d'accès.

**Comment tester**

1. **Accès direct aux ressources**
   - Essayer d'accéder à `/admin` sans être admin
   - Essayer d'accéder à `/api/users` sans authentification
   - Modifier les paramètres URL pour accéder à d'autres ressources

2. **Élévation de privilèges**
   - Se connecter en tant qu'utilisateur normal
   - Essayer d'accéder à des fonctionnalités admin
   - Modifier les paramètres pour changer son rôle

3. **Contournement des contrôles**
   - Utiliser des méthodes HTTP différentes (POST au lieu de GET)
   - Modifier les headers HTTP
   - Utiliser des outils comme Burp Suite pour modifier les requêtes

**Exemple de test**

```
En tant qu'utilisateur normal, essayer d'accéder à :
GET /api/users

Si cela fonctionne, il y a un problème d'autorisation.
```

**Ce qu'il faut documenter**

- Le problème d'autorisation identifié
- La méthode utilisée pour l'exploiter
- Le résultat obtenu
- L'impact potentiel

---

### Étape 5 : Tester la validation des entrées

**Définition**

Les problèmes de validation incluent l'absence de validation, la validation insuffisante, et la validation côté client uniquement.

**Comment tester**

1. **Absence de validation**
   - Envoyer des données invalides (caractères spéciaux, très longues, etc.)
   - Observer si l'application accepte ces données
   - Observer si cela cause des erreurs

2. **Validation insuffisante**
   - Tester avec des données limites (longueur max, caractères spéciaux)
   - Tester avec des types de données incorrects
   - Tester avec des données malformées

3. **Validation côté client uniquement**
   - Désactiver JavaScript dans le navigateur
   - Envoyer directement des requêtes HTTP (avec curl ou Postman)
   - Bypasser la validation JavaScript

**Exemple de test**

```
Champ qui accepte seulement des nombres :
Envoyer : abc123

Si cela est accepté, il y a un problème de validation.
```

**Ce qu'il faut documenter**

- Le problème de validation identifié
- Le point d'entrée vulnérable
- Les données testées
- Le résultat obtenu
- L'impact potentiel

---

## Utiliser les connaissances des rooms précédentes

### Room 2 - Authentification

- Vérifier si les mots de passe sont hashés
- Vérifier si le rate limiting est en place
- Vérifier si les cookies de session sont sécurisés

### Room 3 - SQL Injection

- Tester tous les points d'entrée avec des payloads SQL
- Vérifier si les requêtes préparées sont utilisées
- Tester les différents types d'injections SQL

### Room 4 - XSS

- Tester tous les points d'entrée avec des payloads XSS
- Vérifier si l'échappement HTML est en place
- Tester les trois types de XSS

### Room 5 - API Sécurisée

- Vérifier l'authentification sur les endpoints API
- Vérifier la validation des entrées
- Vérifier le rate limiting
- Vérifier la gestion des erreurs

---

## Outils recommandés

### Navigateur

- **Chrome DevTools** ou **Firefox Developer Tools** : Pour observer les requêtes et réponses
- **Burp Suite Community** : Pour intercepter et modifier les requêtes

### Ligne de commande

- **curl** : Pour tester les endpoints API
- **sqlmap** (avancé) : Pour automatiser les tests d'injection SQL

### Extensions navigateur

- **Cookie Editor** : Pour manipuler les cookies
- **Wappalyzer** : Pour identifier les technologies

---

## Checklist d'analyse

Avant de passer à l'étape suivante, vérifiez que vous avez :

- [ ] Testé tous les points d'entrée pour les injections SQL
- [ ] Testé tous les points d'entrée pour le XSS
- [ ] Testé l'authentification (bypass, mots de passe, sessions)
- [ ] Testé l'autorisation (accès non autorisé, élévation de privilèges)
- [ ] Testé la validation des entrées
- [ ] Documenté chaque vulnérabilité trouvée
- [ ] Reproduit chaque vulnérabilité pour confirmer

---

## Erreurs courantes

**Erreur 1 : Ne pas tester méthodiquement**

Il faut tester chaque point d'entrée de manière systématique. Ne pas sauter d'étapes.

**Erreur 2 : Ne pas documenter immédiatement**

Si vous trouvez une vulnérabilité, documentez-la immédiatement. Vous pourriez oublier les détails plus tard.

**Erreur 3 : Ne pas reproduire les vulnérabilités**

Il faut pouvoir reproduire chaque vulnérabilité pour confirmer qu'elle existe vraiment.

---

## Prochaines étapes

Une fois l'analyse terminée, vous pouvez passer à l'étape suivante : la documentation. Consultez le guide `documentation.md` pour continuer.
